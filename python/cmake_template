##############################################################################
# include the header files
##############################################################################

##############################################################################
# find ROOT
##############################################################################
OPTION(ENABLE_ROOT "Root Desired" ON)

IF(ENABLE_ROOT)
find_package( Root )
if( ROOT_FOUND )
  message(STATUS "Building Root dependent parts")
  message(STATUS "Root include directories:" ${ROOT_INCLUDE_DIRS})
  message(STATUS "Root library directories:" ${ROOT_LIBRARY_DIRS})
  set (ROOT_LIBRARIES Core Hist Tree Table Matrix MathCore MathMore Gpad Graf Postscript RIO)
  add_definitions(-DWANTROOT)
else( ROOT_FOUND )
  message(FATAL_ERROR "Root is required for MPILib")
endif( ROOT_FOUND )

# TODO:  This is ugly and must be fixed in the windows install procedure
if (WIN32)
SET (LIB_PREFIX lib)
else (WIN32)
SET (CBLAS_PREFIX gsl)
endif (WIN32)
ENDIF (ENABLE_ROOT)

#############################################################################

cmake_minimum_required(VERSION 2.8)
FIND_PACKAGE(GSL REQUIRED)

set(MIIND_LIBRARY_PREFIX miind)

include_directories( ${CMAKE_SOURCE_DIR}/libs )
include_directories( ${CMAKE_SOURCE_DIR}/libs/GeomLib )

include_directories( ${GSL_INCLUDE_DIRS} )
link_directories( ${GSL_LIBRARY_DIRS} )
include_directories( ${ROOT_INCLUDE_DIRS} )
link_directories( ${ROOT_LIBRARY_DIRS} )

##############################################################################
# find boost with mpi
##############################################################################
IF(ENABLE_MPI)
        find_package( Boost COMPONENTS unit_test_framework filesystem program_options mpi thread serialization timer system)
ELSE(ENABLE_MPI)
	find_package( Boost COMPONENTS unit_test_framework filesystem program_options thread serialization timer system)
ENDIF(ENABLE_MPI)
if( Boost_FOUND )
   message(STATUS "Boost found setting up directories")
   message(STATUS "BOOST_ROOT: " ${BOOST_ROOT} )
   message(STATUS "Boost include directories:" ${Boost_INCLUDE_DIR} )
   message(STATUS "Boost library directories:" ${Boost_LIBRARY_DIRS} )
   include_directories( ${Boost_INCLUDE_DIR} )
   link_directories( ${Boost_LIBRARY_DIR} )
else ( Boost_FOUND )
   message(FATAL_ERROR "Boost is mandatory to build the libraries")
endif( Boost_FOUND )

#############################################################################
# Libraries
#############################################################################

if (UNIX)
   ADD_DEFINITIONS("-fno-strict-aliasing" )
endif (UNIX)
set ( LIBLIST       
    ${MIIND_LIBRARY_PREFIX}geom
    ${MIIND_LIBRARY_PREFIX}mpi           
    ${MIIND_LIBRARY_PREFIX}numtools
    ${MPI_LIBRARIES} 
    ${ROOT_LIBRARIES}
    ${Boost_LIBRARIES}
    ${gsl_LINK_FLAGS} 
    gsl
)


#############################################################################
# executables
#############################################################################
add_definitions("-std=gnu++11 -DWANTROOT")
